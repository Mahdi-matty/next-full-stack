"use strict";(()=>{var e={};e.id=912,e.ids=[912],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},63477:e=>{e.exports=require("querystring")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},27528:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>y,patchFetch:()=>g,requestAsyncStorage:()=>m,routeModule:()=>h,serverHooks:()=>w,staticGenerationAsyncStorage:()=>x});var s={};t.r(s),t.d(s,{GET:()=>l,POST:()=>l});var a=t(49303),o=t(88716),n=t(60670),i=t(75571),u=t.n(i),d=t(53797),c=t(49758),p=t(19893);t(42023),t(77210);let l=u()({providers:[(0,d.Z)({credentials:{username:{label:"Username",type:"text",placeholder:"jsmith"},password:{label:"Password",type:"password"}},async authorize(e){try{await (0,p.P)();let r=await c.Z.findOne({username:e.username});if(!r)throw Error("Wrong credentials! no such a user");if(console.log("Provided password:",e.password),console.log("Stored password:",r.password),!r||!await r.isCorrectPassword(e.password))return null;return r}catch(e){console.log(e)}}})],callbacks:{async session({session:e}){try{let r=await c.Z.findOne({email:e?.user?.email});r&&(e.user.id=r._id.toString())}catch(e){console.error("Error in session callback:",e)}return e},async signIn(e){try{return await (0,p.P)(),!0}catch(e){return console.error(e),!1}}},session:{maxAge:7200}}),h=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"C:\\Users\\Lenovo\\bootcamp\\css-minip\\next-full-stack\\app\\api\\auth\\[...nextauth]\\route.js",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:x,serverHooks:w}=h,y="/api/auth/[...nextauth]/route";function g(){return(0,n.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:x})}},23521:(e,r,t)=>{t.d(r,{Z:()=>o});var s=t(11185);let a=new s.Schema({product:{type:s.Schema.Types.ObjectId,ref:"Product"},productName:{type:String},price:{type:Number}}),o=s.models.Order||(0,s.model)("Order",a)},49758:(e,r,t)=>{t.d(r,{Z:()=>u});var s=t(11185),a=t(42023),o=t.n(a),n=t(23521);let i=new s.Schema({email:{type:String,unique:[!0,"Email already exist"],required:[!0,"Email is needed"]},username:{type:String,unique:[!0,"username already exist"],required:[!0,"username is needed"]},password:{type:String,required:[!0,"password is required"],minlength:[8,"password must be at least 8 charachters"]},image:{type:String},orders:[n.Z.schema]});i.pre("save",async function(e){(this.isNew||this.isModified("password"))&&(this.password=await o().hash(this.password,10)),e()}),i.methods.isCorrectPassword=async function(e){return await o().compare(e,this.password)};let u=s.models.User||(0,s.model)("User",i)},53797:(e,r)=>{r.Z=function(e){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:e}}},77210:(e,r)=>{},19893:(e,r,t)=>{t.d(r,{P:()=>n});var s=t(11185),a=t.n(s);let o=!1,n=async()=>{if(a().set("strictQuery",!0),o){console.log("Already connected to the database.");return}try{await a().connect(process.env.MOONGODB_URI||"mongodb://127.0.0.1:27017/",{dbName:"Mahdi",useNewUrlParser:!0,useUnifiedTopology:!0}),o=!0,console.log("Connected to the database.")}catch(e){throw console.error("Error connecting to the database:",e),e}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[948,518,571],()=>t(27528));module.exports=s})();